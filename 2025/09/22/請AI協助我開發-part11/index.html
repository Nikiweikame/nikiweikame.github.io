<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>è«‹AIå”åŠ©æˆ‘é–‹ç™¼-part11 | Nikiçš„Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="login ç™»å…¥ç¨‹åºçš„é¸æ“‡å¸¸è¦‹çš„ç™»å…¥é©—è­‰ä¸­æˆ‘é¸æ“‡ä½¿ç”¨Token-Based Authenticationï¼ˆJWT ç‚ºä¸»æµï¼‰  æµç¨‹  ä½¿ç”¨è€…è¼¸å…¥å¸³å¯† â†’ å¾Œç«¯ç°½ç™¼ JWTå‰ç«¯å„²å­˜åœ¨ localStorage &#x2F; Cookieå¾ŒçºŒè«‹æ±‚åœ¨ Authorization: Bearer  å‚³çµ¦å¾Œç«¯å¾Œç«¯é©—è­‰ç°½åèˆ‡æœ‰æ•ˆæœŸå³å¯  å„ªé»  ç„¡ç‹€æ…‹ï¼ˆStatelessï¼‰ï¼Œé©åˆ APIã€å¾®æœå‹™è·¨å¹³å°ï¼ˆWeb">
<meta property="og:type" content="article">
<meta property="og:title" content="è«‹AIå”åŠ©æˆ‘é–‹ç™¼-part11">
<meta property="og:url" content="https://nikiweikame.github.io/2025/09/22/%E8%AB%8BAI%E5%8D%94%E5%8A%A9%E6%88%91%E9%96%8B%E7%99%BC-part11/index.html">
<meta property="og:site_name" content="Nikiçš„Blog">
<meta property="og:description" content="login ç™»å…¥ç¨‹åºçš„é¸æ“‡å¸¸è¦‹çš„ç™»å…¥é©—è­‰ä¸­æˆ‘é¸æ“‡ä½¿ç”¨Token-Based Authenticationï¼ˆJWT ç‚ºä¸»æµï¼‰  æµç¨‹  ä½¿ç”¨è€…è¼¸å…¥å¸³å¯† â†’ å¾Œç«¯ç°½ç™¼ JWTå‰ç«¯å„²å­˜åœ¨ localStorage &#x2F; Cookieå¾ŒçºŒè«‹æ±‚åœ¨ Authorization: Bearer  å‚³çµ¦å¾Œç«¯å¾Œç«¯é©—è­‰ç°½åèˆ‡æœ‰æ•ˆæœŸå³å¯  å„ªé»  ç„¡ç‹€æ…‹ï¼ˆStatelessï¼‰ï¼Œé©åˆ APIã€å¾®æœå‹™è·¨å¹³å°ï¼ˆWeb">
<meta property="og:locale">
<meta property="article:published_time" content="2025-09-22T07:08:53.000Z">
<meta property="article:modified_time" content="2025-09-25T10:21:08.983Z">
<meta property="article:author" content="Niki_wei">
<meta property="article:tag" content="back-end">
<meta property="article:tag" content="AI">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Nikiçš„Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Nikiçš„Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">ç´€éŒ„äº†Nikiæˆé•·çš„é»é»æ»´æ»´</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Suche"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://nikiweikame.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-è«‹AIå”åŠ©æˆ‘é–‹ç™¼-part11" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/09/22/%E8%AB%8BAI%E5%8D%94%E5%8A%A9%E6%88%91%E9%96%8B%E7%99%BC-part11/" class="article-date">
  <time class="dt-published" datetime="2025-09-22T07:08:53.000Z" itemprop="datePublished">2025-09-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      è«‹AIå”åŠ©æˆ‘é–‹ç™¼-part11
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="login-ç™»å…¥ç¨‹åºçš„é¸æ“‡"><a href="#login-ç™»å…¥ç¨‹åºçš„é¸æ“‡" class="headerlink" title="login ç™»å…¥ç¨‹åºçš„é¸æ“‡"></a>login ç™»å…¥ç¨‹åºçš„é¸æ“‡</h1><p>å¸¸è¦‹çš„ç™»å…¥é©—è­‰ä¸­æˆ‘é¸æ“‡ä½¿ç”¨Token-Based Authenticationï¼ˆJWT ç‚ºä¸»æµï¼‰</p>
<ul>
<li>æµç¨‹</li>
</ul>
<p>ä½¿ç”¨è€…è¼¸å…¥å¸³å¯† â†’ å¾Œç«¯ç°½ç™¼ JWT<br>å‰ç«¯å„²å­˜åœ¨ localStorage &#x2F; Cookie<br>å¾ŒçºŒè«‹æ±‚åœ¨ Authorization: Bearer <token> å‚³çµ¦å¾Œç«¯<br>å¾Œç«¯é©—è­‰ç°½åèˆ‡æœ‰æ•ˆæœŸå³å¯</p>
<ul>
<li>å„ªé»</li>
</ul>
<p>ç„¡ç‹€æ…‹ï¼ˆStatelessï¼‰ï¼Œé©åˆ APIã€å¾®æœå‹™<br>è·¨å¹³å°ï¼ˆWebã€iOSã€Android éƒ½èƒ½ç”¨ï¼‰</p>
<ul>
<li>ç¼ºé»</li>
</ul>
<p>Token æ´©æ¼å³é­æ¿«ç”¨ï¼ˆéœ€æ­é… HTTPSã€éæœŸæ©Ÿåˆ¶ï¼‰<br>Token ç„¡æ³•è¼•æ˜“è¨»éŠ·ï¼ˆéœ€é¡å¤–é»‘åå–®æ©Ÿåˆ¶ï¼‰</p>
<h2 id="å®‰è£å¥—ä»¶"><a href="#å®‰è£å¥—ä»¶" class="headerlink" title="å®‰è£å¥—ä»¶"></a>å®‰è£å¥—ä»¶</h2><p>ç”¨ tymon&#x2F;jwt-authï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require tymon/jwt-auth</span><br></pre></td></tr></table></figure>
<p>å®‰è£å®Œæˆå¾Œï¼Œç™¼ä½ˆè¨­å®šæª”ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan vendor:publish --provider=&quot;Tymon\JWTAuth\Providers\LaravelServiceProvider&quot;</span><br></pre></td></tr></table></figure>
<p>é€™æœƒåœ¨ config&#x2F;jwt.php ç”Ÿæˆè¨­å®šæª”ã€‚</p>
<p>æ¥è‘—ç”Ÿæˆ JWT ç§˜é‘°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan jwt:secret</span><br></pre></td></tr></table></figure>
<p>é€™æœƒåœ¨ .env åŠ å…¥ä¸€è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JWT_SECRET=éš¨æ©Ÿå­—ä¸²</span><br></pre></td></tr></table></figure>

<h2 id="ä¿®æ”¹-User-Model"><a href="#ä¿®æ”¹-User-Model" class="headerlink" title="ä¿®æ”¹ User Model"></a>ä¿®æ”¹ User Model</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Models;</span><br><span class="line"></span><br><span class="line">// use Illuminate\Contracts\Auth\MustVerifyEmail;</span><br><span class="line">// èªè­‰ç›¸é—œçš„åŸºåº•é¡</span><br><span class="line">use Illuminate\Foundation\Auth\User as Authenticatable;</span><br><span class="line">// é€šçŸ¥ç›¸é—œ</span><br><span class="line">use Illuminate\Notifications\Notifiable;</span><br><span class="line">// å‡è³‡æ–™å·¥å» </span><br><span class="line">use Illuminate\Database\Eloquent\Factories\HasFactory;</span><br><span class="line">// åŠ ä¸ŠJWT ç›¸é—œä»‹é¢</span><br><span class="line">use Tymon\JWTAuth\Contracts\JWTSubject;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class User extends Authenticatable implements JWTSubject //å¾Œé¢åŠ ä¸Š implements JWTSubject</span><br><span class="line">&#123;</span><br><span class="line">    // åŠ ä¸ŠJWTSubject éœ€è¦å¯¦ä½œå…©å€‹æ–¹æ³•</span><br><span class="line">    public function getJWTIdentifier()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;getKey(); // é€šå¸¸æ˜¯ id</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getJWTCustomClaims()</span><br><span class="line">    &#123;</span><br><span class="line">        return [];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ModelåŸæœ¬æœ‰çš„å…§å®¹ä¾èˆŠä¿ç•™ï¼Œåªæ˜¯å¢åŠ ä¸€äº›å¯¦ä½œJWTéœ€è¦çš„æ–¹æ³•</p>
<h2 id="å»ºç«‹-AuthController"><a href="#å»ºç«‹-AuthController" class="headerlink" title="å»ºç«‹ AuthController"></a>å»ºç«‹ AuthController</h2><p>æˆ‘æŠŠuserçš„å¯†ç¢¼æ¬„ä½åç¨±æ”¹æˆpasswordï¼Œå¾ŒçºŒæ“ä½œæœƒå–®ç´”å¾ˆå¤šï¼Œå› ç‚ºï¼š<br>Laravel é è¨­èªå¯†ç¢¼æ¬„ä½å°±æ˜¯ password</p>
<p>åœ¨ app&#x2F;Http&#x2F;Controllers å»ºç«‹ AuthController.phpï¼Œä¸¦ä¸”è£¡é¢æœ‰åŸºæœ¬çš„ä¸‰å€‹æ–¹æ³•login,me,logout</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Http\Controllers;</span><br><span class="line"></span><br><span class="line">use Illuminate\Http\Request;</span><br><span class="line">use App\Models\User;</span><br><span class="line">use Illuminate\Support\Facades\Hash;</span><br><span class="line">use Tymon\JWTAuth\Facades\JWTAuth;</span><br><span class="line"></span><br><span class="line">class AuthController extends Controller</span><br><span class="line">&#123;</span><br><span class="line">    // ç™»å…¥</span><br><span class="line">    public function login(Request $request)</span><br><span class="line">    &#123;</span><br><span class="line">        $credentials = $request-&gt;validate([</span><br><span class="line">            &#x27;user_id&#x27; =&gt; &#x27;required|string&#x27;,</span><br><span class="line">            &#x27;password&#x27; =&gt; &#x27;required|string&#x27;,</span><br><span class="line">        ]);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            // å˜—è©¦ç™»å…¥ä¸¦ç”¢ç”Ÿ JWT token</span><br><span class="line">            if (!$token = JWTAuth::attempt($credentials)) &#123;</span><br><span class="line">                return response()-&gt;json([&#x27;error&#x27; =&gt; &#x27;Invalid credentials&#x27;], 401);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (JWTException $e) &#123;</span><br><span class="line">            return response()-&gt;json([&#x27;error&#x27; =&gt; &#x27;Could not create token&#x27;], 500);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // ç™»å…¥æˆåŠŸï¼Œå›å‚³ token</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;access_token&#x27; =&gt; $token,</span><br><span class="line">            &#x27;token_type&#x27; =&gt; &#x27;bearer&#x27;,</span><br><span class="line">            &#x27;expires_in&#x27; =&gt; JWTAuth::factory()-&gt;getTTL() * 60, // é€™æ¨£æ‰æœƒç”¨ JWT TTL</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å–å¾—ç•¶å‰ä½¿ç”¨è€…è³‡æ–™</span><br><span class="line">     */</span><br><span class="line">    public function me()</span><br><span class="line">    &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            $user = JWTAuth::parseToken()-&gt;authenticate();</span><br><span class="line">        &#125; catch (\Exception $e) &#123;</span><br><span class="line">            return response()-&gt;json([&#x27;error&#x27; =&gt; &#x27;Token invalid or expired&#x27;], 401);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return response()-&gt;json($user);</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * ä½¿ç”¨è€…ç™»å‡ºï¼ˆå°‡ token å¤±æ•ˆï¼‰</span><br><span class="line">     */</span><br><span class="line">    public function logout(Request $request)</span><br><span class="line">    &#123;</span><br><span class="line">        $token = $request-&gt;bearerToken();</span><br><span class="line">        if ($token) &#123;</span><br><span class="line">            JWTAuth::invalidate($token);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return response()-&gt;json([&#x27;message&#x27; =&gt; &#x27;Successfully logged out&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€™æ™‚æˆ‘å°±æœ‰å•é¡Œï¼Œ</p>
<ol>
<li>é€™æ¨£APIå›å‚³çš„æ ¼å¼ä¸çµ±ä¸€ï¼Œ</li>
<li>å‰ç«¯è¦æ‰“å…©æ¬¡APIæ‰èƒ½æ‹¿åˆ°ä½¿ç”¨è€…çš„è³‡è¨Š</li>
</ol>
<p>æ„›é†¬ä¹ŸèªåŒæˆ‘çš„ç–‘æƒ‘ï¼Œé€™æœƒé€ æˆå‰ç«¯è™•ç†ä¸Šä¸å¤ªä¸€è‡´ï¼Œå› ç‚ºå¯èƒ½è¦å…ˆåˆ¤æ–·æœ‰æ²’æœ‰ access_token æ‰çŸ¥é“æˆåŠŸæˆ–å¤±æ•—ã€‚<br>ä¸¦å»ºè­°åšäº›èª¿æ•´ï¼Œçµ±ä¸€å›å‚³ä¸€å€‹å›ºå®šçµæ§‹<br>åƒæ˜¯é€™æ¨£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;success&quot;: true/false,</span><br><span class="line">    &quot;data&quot;: &#123;...&#125;,      // æˆåŠŸæ™‚æ”¾ token + user</span><br><span class="line">    &quot;message&quot;: &quot;æè¿°æ–‡å­—&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¿®æ­£å¾Œçš„AuthController.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Http\Controllers;</span><br><span class="line"></span><br><span class="line">use App\Models\User;</span><br><span class="line">use Illuminate\Http\Request;</span><br><span class="line">use Tymon\JWTAuth\Facades\JWTAuth;</span><br><span class="line"></span><br><span class="line">class AuthController extends Controller</span><br><span class="line">&#123;</span><br><span class="line">    // ç™»å…¥</span><br><span class="line"></span><br><span class="line">    public function login(Request $request)</span><br><span class="line">    &#123;</span><br><span class="line">        $credentials = $request-&gt;validate([</span><br><span class="line">            &#x27;user_id&#x27; =&gt; &#x27;required|string&#x27;,</span><br><span class="line">            &#x27;password&#x27; =&gt; &#x27;required|string&#x27;,</span><br><span class="line">        ]);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            // å˜—è©¦ç™»å…¥ä¸¦ç”¢ç”Ÿ JWT token</span><br><span class="line">            if (! $token = JWTAuth::attempt($credentials)) &#123;</span><br><span class="line">                return response()-&gt;json([</span><br><span class="line">                    &#x27;success&#x27; =&gt; false,</span><br><span class="line">                    &#x27;data&#x27; =&gt; null,</span><br><span class="line">                    &#x27;message&#x27; =&gt; &#x27;Invalid credentials&#x27;,</span><br><span class="line">                ], 401);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (JWTException $e) &#123;</span><br><span class="line">            return response()-&gt;json([</span><br><span class="line">                &#x27;success&#x27; =&gt; false,</span><br><span class="line">                &#x27;data&#x27; =&gt; null,</span><br><span class="line">                &#x27;message&#x27; =&gt; &#x27;Could not create token&#x27;,</span><br><span class="line">            ], 500);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // ç™»å…¥æˆåŠŸï¼Œå›å‚³ token + user</span><br><span class="line">        $user = auth()-&gt;user(); // å–å¾—ç™»å…¥çš„ä½¿ç”¨è€…</span><br><span class="line"></span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; true,</span><br><span class="line">            &#x27;data&#x27; =&gt; [</span><br><span class="line">                &#x27;access_token&#x27; =&gt; $token,</span><br><span class="line">                &#x27;token_type&#x27; =&gt; &#x27;bearer&#x27;,</span><br><span class="line">                &#x27;expires_in&#x27; =&gt; JWTAuth::factory()-&gt;getTTL() * 60,</span><br><span class="line">                &#x27;user&#x27; =&gt; $user,</span><br><span class="line">            ],</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Login successful&#x27;,</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å–å¾—ç•¶å‰ä½¿ç”¨è€…è³‡æ–™</span><br><span class="line">     */</span><br><span class="line">    public function me()</span><br><span class="line">    &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            $user = JWTAuth::parseToken()-&gt;authenticate();</span><br><span class="line"></span><br><span class="line">            return response()-&gt;json([</span><br><span class="line">                &#x27;success&#x27; =&gt; true,</span><br><span class="line">                &#x27;data&#x27; =&gt; $user,</span><br><span class="line">                &#x27;message&#x27; =&gt; &#x27;User fetched successfully&#x27;,</span><br><span class="line">            ]);</span><br><span class="line">        &#125; catch (\Tymon\JWTAuth\Exceptions\TokenExpiredException $e) &#123;</span><br><span class="line">            return response()-&gt;json([</span><br><span class="line">                &#x27;success&#x27; =&gt; false,</span><br><span class="line">                &#x27;message&#x27; =&gt; &#x27;Token has expired&#x27;,</span><br><span class="line">            ], 401);</span><br><span class="line">        &#125; catch (\Tymon\JWTAuth\Exceptions\TokenInvalidException $e) &#123;</span><br><span class="line">            return response()-&gt;json([</span><br><span class="line">                &#x27;success&#x27; =&gt; false,</span><br><span class="line">                &#x27;message&#x27; =&gt; &#x27;Token is invalid&#x27;,</span><br><span class="line">            ], 401);</span><br><span class="line">        &#125; catch (\Tymon\JWTAuth\Exceptions\JWTException $e) &#123;</span><br><span class="line">            return response()-&gt;json([</span><br><span class="line">                &#x27;success&#x27; =&gt; false,</span><br><span class="line">                &#x27;message&#x27; =&gt; &#x27;Token not provided&#x27;,</span><br><span class="line">            ], 401);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä½¿ç”¨è€…ç™»å‡ºï¼ˆå°‡ token å¤±æ•ˆï¼‰</span><br><span class="line">     */</span><br><span class="line">    public function logout(Request $request)</span><br><span class="line">    &#123;</span><br><span class="line">        $token = $request-&gt;bearerToken();</span><br><span class="line">        if ($token) &#123;</span><br><span class="line">            JWTAuth::invalidate($token); //æŠŠ token åŠ åˆ° é»‘åå–® (blacklist)ï¼Œè®“å®ƒå³ä½¿é‚„æ²’éæœŸä¹Ÿä¸èƒ½å†ç”¨</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return response()-&gt;json([&#x27;message&#x27; =&gt; &#x27;Successfully logged out&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡å°fuction me è·Ÿ logout è§£èªª</p>
<h2 id="function-me-ç²å–ä½¿ç”¨è€…è³‡æ–™"><a href="#function-me-ç²å–ä½¿ç”¨è€…è³‡æ–™" class="headerlink" title="function me ç²å–ä½¿ç”¨è€…è³‡æ–™"></a>function me ç²å–ä½¿ç”¨è€…è³‡æ–™</h2><p>æ ¸å¿ƒçš„å…§å®¹æ˜¯é€™è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$user = JWTAuth::parseToken()-&gt;authenticate();</span><br></pre></td></tr></table></figure>
<ul>
<li>parseToken()ï¼šæœƒå¾ request header çš„ Authorization: Bearer <token> è£¡è‡ªå‹•å–å‡º JWTã€‚</li>
<li>authenticate()ï¼šè§£ç¢¼ JWT â†’ ç¢ºèª token æ˜¯å¦æœ‰æ•ˆã€æ˜¯å¦éæœŸ â†’ å¦‚æœæ­£å¸¸å°±å›å‚³å°æ‡‰çš„ä½¿ç”¨è€…ã€‚<br>ğŸ‘‰ æ‰€ä»¥é€™è£¡å·²ç¶“éš±å«äº† token é©—è­‰ã€‚å¦‚æœ token ç„¡æ•ˆ&#x2F;éæœŸï¼Œæœƒç›´æ¥ä¸Ÿä¾‹å¤– (TokenExpiredException &#x2F; TokenInvalidException)ã€‚</li>
</ul>
<p>JWTï¼ˆJSON Web Tokenï¼‰æœ¬èº«å°±åŒ…å«äº† ä½¿ç”¨è€…çš„è­˜åˆ¥è³‡è¨Šï¼Œ<br>åœ¨è§£æ Tokenä¹‹å¾Œå¯ä»¥è®€å– Payloadï¼Œä¹‹å¾Œè¼‰å…¥ä½¿ç”¨è€…è³‡è¨Š</p>
<h2 id="fuction-logout-ä½¿ç”¨è€…ç™»å‡º"><a href="#fuction-logout-ä½¿ç”¨è€…ç™»å‡º" class="headerlink" title="fuction logout ä½¿ç”¨è€…ç™»å‡º"></a>fuction logout ä½¿ç”¨è€…ç™»å‡º</h2><p>ç™»å‡ºæ˜¯è¦ è®“ token ç«‹å³å¤±æ•ˆã€‚<br>JWT æœ¬è³ªä¸Šæ˜¯ã€Œç„¡ç‹€æ…‹ã€çš„ï¼Œç†è«–ä¸Šåªè¦ç°½ç™¼å°±æœƒä¸€ç›´æœ‰æ•ˆåˆ°éæœŸæ™‚é–“ç‚ºæ­¢ã€‚<br>invalidate($token) çš„æ„æ€æ˜¯æŠŠ token åŠ åˆ° é»‘åå–® (blacklist)ï¼Œè®“å®ƒå³ä½¿é‚„æ²’éæœŸä¹Ÿä¸èƒ½å†ç”¨ã€‚<br>æ‰€ä»¥é€™è£¡è¦æ‰‹å‹•æ‹¿å‡º token ä¸Ÿçµ¦ invalidate()ã€‚</p>
<h2 id="fuction-register-ä½¿ç”¨è€…è¨»å†Š"><a href="#fuction-register-ä½¿ç”¨è€…è¨»å†Š" class="headerlink" title="fuction register ä½¿ç”¨è€…è¨»å†Š"></a>fuction register ä½¿ç”¨è€…è¨»å†Š</h2><p>ä¹‹å¾ŒåŠ ä¸Šä½¿ç”¨è€…è¨»å†Šçš„åŠŸèƒ½</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * ä½¿ç”¨è€…è¨»å†Š</span><br><span class="line"> */</span><br><span class="line">public function register(Request $request)</span><br><span class="line">&#123;</span><br><span class="line">    $validated = $request-&gt;validate([</span><br><span class="line">        &#x27;user_id&#x27; =&gt; &#x27;required|string|max:50|unique:users,user_id&#x27;,</span><br><span class="line">        &#x27;password&#x27; =&gt; &#x27;required|string|min:6&#x27;,</span><br><span class="line">        &#x27;nickname&#x27; =&gt; &#x27;required|string|max:50&#x27;,</span><br><span class="line">        &#x27;weight&#x27; =&gt; &#x27;nullable|numeric|min:0&#x27;,</span><br><span class="line">        &#x27;status&#x27; =&gt; &#x27;required|string|max:50&#x27;,</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        // å»ºç«‹ä½¿ç”¨è€…</span><br><span class="line">        $user = User::create([</span><br><span class="line">            &#x27;user_id&#x27; =&gt; $validated[&#x27;user_id&#x27;],</span><br><span class="line">            &#x27;password&#x27; =&gt; bcrypt($validated[&#x27;password&#x27;]), // bcrypt åŠ å¯†</span><br><span class="line">            &#x27;nickname&#x27; =&gt; $validated[&#x27;nickname&#x27;],</span><br><span class="line">            &#x27;weight&#x27; =&gt; $validated[&#x27;weight&#x27;] ?? 60.0, // é è¨­é«”é‡ 60.0</span><br><span class="line">            &#x27;status&#x27; =&gt; &quot;active&quot;,</span><br><span class="line">            &#x27;last_login_at&#x27; =&gt; null,</span><br><span class="line">            &#x27;password_change_at&#x27; =&gt; now(), // è¨»å†Šæ™‚é è¨­å¯†ç¢¼è¨­å®šæ™‚é–“</span><br><span class="line">        ]);</span><br><span class="line"></span><br><span class="line">        // è¨»å†Šå®Œæˆé¦¬ä¸Šç™»å…¥ä¸¦å›å‚³ token</span><br><span class="line">        $token = JWTAuth::fromUser($user);</span><br><span class="line"></span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; true,</span><br><span class="line">            &#x27;data&#x27; =&gt; [</span><br><span class="line">                &#x27;user&#x27; =&gt; $user,</span><br><span class="line">                &#x27;access_token&#x27; =&gt; $token,</span><br><span class="line">                &#x27;token_type&#x27; =&gt; &#x27;bearer&#x27;,</span><br><span class="line">                &#x27;expires_in&#x27; =&gt; JWTAuth::factory()-&gt;getTTL() * 60,</span><br><span class="line">            ],</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;User registered successfully&#x27;,</span><br><span class="line">        ], 201);</span><br><span class="line"></span><br><span class="line">    &#125; catch (\Exception $e) &#123;</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; false,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Registration failed&#x27;,</span><br><span class="line">            &#x27;error&#x27; =&gt; $e-&gt;getMessage(),</span><br><span class="line">        ], 500);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="updateProfile-ä½¿ç”¨è€…æ›´æ–°è³‡æ–™"><a href="#updateProfile-ä½¿ç”¨è€…æ›´æ–°è³‡æ–™" class="headerlink" title="updateProfile ä½¿ç”¨è€…æ›´æ–°è³‡æ–™"></a>updateProfile ä½¿ç”¨è€…æ›´æ–°è³‡æ–™</h2><p>å¸¸è¦‹çš„ å¸³è™Ÿç”Ÿå‘½é€±æœŸ APIåŒ…å«ä¸‹é¢å¹¾å€‹<br>âœ… login<br>âœ… register<br>âœ… me<br>âœ… logout<br>âœ… updateProfile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * æ›´æ–°ä½¿ç”¨è€…è³‡æ–™</span><br><span class="line"> */</span><br><span class="line">public function updateProfile(Request $request)</span><br><span class="line">&#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        $user = JWTAuth::parseToken()-&gt;authenticate();</span><br><span class="line"></span><br><span class="line">    $validated = $request-&gt;validate([</span><br><span class="line">        &#x27;nickname&#x27; =&gt; &#x27;nullable|string|max:50&#x27;,</span><br><span class="line">        &#x27;weight&#x27;   =&gt; &#x27;nullable|numeric|min:0&#x27;,</span><br><span class="line">        &#x27;password&#x27; =&gt; &#x27;nullable|string|min:6|confirmed&#x27;, // confirmed æœƒæª¢æŸ¥ password_confirmation</span><br><span class="line">    ]);</span><br><span class="line">    if (isset($validated[&#x27;nickname&#x27;])) &#123;</span><br><span class="line">        $user-&gt;nickname = $validated[&#x27;nickname&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (isset($validated[&#x27;weight&#x27;])) &#123;</span><br><span class="line">        $user-&gt;weight = $validated[&#x27;weight&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (isset($validated[&#x27;password&#x27;])) &#123;</span><br><span class="line">        $user-&gt;password = bcrypt($validated[&#x27;password&#x27;]);</span><br><span class="line">        $user-&gt;password_change_at = now();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $user-&gt;save();</span><br><span class="line">    &#125; catch (\Tymon\JWTAuth\Exceptions\TokenExpiredException $e) &#123;</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; false,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Token has expired&#x27;,</span><br><span class="line">        ], 401);</span><br><span class="line">    &#125; catch (\Tymon\JWTAuth\Exceptions\TokenInvalidException $e) &#123;</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; false,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Token is invalid&#x27;,</span><br><span class="line">        ], 401);</span><br><span class="line">    &#125; catch (\Tymon\JWTAuth\Exceptions\JWTException $e) &#123;</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; false,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Token not provided&#x27;,</span><br><span class="line">        ], 401);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€™å€‹åšæ³•æ˜¯å°‡å…¶ä»–å€‹äººè³‡æ–™æ›´æ–°èˆ‡å¯†ç¢¼æ›´æ–°æ”¾åœ¨ä¸€èµ·ï¼Œé›–ç„¶ç°¡å–®æ–¹ä¾¿ä½†æ˜¯å®‰å…¨æ€§æˆ‘å°±ä¸æ˜¯å¾ˆæ»¿æ„ï¼Œä¹Ÿè·Ÿå¸¸æ¥è§¸çš„ä¿®è©²è³‡æ–™æœ‰é»ä¸ä¸€æ¨£</p>
<p>æœ‰äº›äººæœƒé¸æ“‡å€‹äººè³‡æ–™æ›´æ–°èˆ‡æ›´æ–°å¯†ç¢¼åˆ†å…©å€‹APIåŸ·è¡Œ<br>è®“å¯†ç¢¼æ›´æ–°çš„APIéœ€è¦è¼¸å…¥èˆŠå¯†ç¢¼å¢åŠ å®‰å…¨æ€§<br>æˆ–æ˜¯æ‰€æœ‰æ›´æ–°éƒ½éœ€è¦è¼¸å…¥å¯†ç¢¼ï¼Œä½†æ˜¯æœƒè®“ä½¿ç”¨è€…é«”é©—æ¥µå·®<br>æˆ‘æƒ³æƒ³èƒ½ä¸èƒ½åƒ…æœ‰æ•æ„Ÿè³‡è¨Šéœ€è¦è¼¸å…¥å¯†ç¢¼ï¼Œå…¶ä»–ç›´æ¥æ›´æ–°å°±å¥½</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">public function updateProfile(Request $request)</span><br><span class="line">&#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        $user = JWTAuth::parseToken()-&gt;authenticate();</span><br><span class="line"></span><br><span class="line">    $validated = $request-&gt;validate([</span><br><span class="line">        &#x27;nickname&#x27; =&gt; &#x27;nullable|string|max:50&#x27;,</span><br><span class="line">        &#x27;weight&#x27;   =&gt; &#x27;nullable|numeric|min:0&#x27;,</span><br><span class="line">        &#x27;password&#x27; =&gt; &#x27;nullable|string|min:6&#x27;, // æ–°å¯†ç¢¼</span><br><span class="line">        &#x27;old_password&#x27; =&gt; &#x27;required_with:password|string&#x27;, // ç•¶è¦æ”¹å¯†ç¢¼æ™‚ï¼ŒèˆŠå¯†ç¢¼å¿…å¡«</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">        // å¦‚æœè¦æ›´æ–°å¯†ç¢¼ â†’ é©—è­‰èˆŠå¯†ç¢¼</span><br><span class="line">        if ($request-&gt;has(&#x27;password&#x27;)) &#123;</span><br><span class="line">            if (! Hash::check($request-&gt;input(&#x27;old_password&#x27;), $user-&gt;password)) &#123;</span><br><span class="line">                rreturn response()-&gt;json([</span><br><span class="line">                &#x27;success&#x27; =&gt; false,</span><br><span class="line">                &#x27;message&#x27; =&gt; &#x27;èˆŠå¯†ç¢¼éŒ¯èª¤&#x27;,</span><br><span class="line">            ], 403);</span><br><span class="line">            &#125;</span><br><span class="line">            $user-&gt;password = bcrypt($request-&gt;input(&#x27;password&#x27;));</span><br><span class="line">            $user-&gt;password_change_at = now();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    // æ›´æ–°å…¶ä»–æ¬„ä½</span><br><span class="line">    if (isset($validated[&#x27;nickname&#x27;])) &#123;</span><br><span class="line">        $user-&gt;nickname = $validated[&#x27;nickname&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (isset($validated[&#x27;weight&#x27;])) &#123;</span><br><span class="line">        $user-&gt;weight = $validated[&#x27;weight&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line">        $user-&gt;save();</span><br><span class="line"></span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; true,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;è³‡æ–™æ›´æ–°æˆåŠŸ&#x27;,</span><br><span class="line">            &#x27;data&#x27; =&gt; $user,</span><br><span class="line">        ]);</span><br><span class="line">    &#125; catch (\Tymon\JWTAuth\Exceptions\TokenExpiredException $e) &#123;</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; false,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Token has expired&#x27;,</span><br><span class="line">        ], 401);</span><br><span class="line">    &#125; catch (\Tymon\JWTAuth\Exceptions\TokenInvalidException $e) &#123;</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; false,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Token is invalid&#x27;,</span><br><span class="line">        ], 401);</span><br><span class="line">    &#125; catch (\Tymon\JWTAuth\Exceptions\JWTException $e) &#123;</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &#x27;success&#x27; =&gt; false,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;Token not provided&#x27;,</span><br><span class="line">        ], 401);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é›–ç„¶é‹ç”¨fill()æ‰¹é‡è³¦å€¼è™•ç†(ä¸€æ¬¡æŠŠé™£åˆ—ä¸­çš„å¤šå€‹æ¬„ä½ä¸Ÿçµ¦ model)ã€‚<br>ç°¡æ½”ã€å¥½ç¶­è­·ã€é©åˆæ›´æ–°å¤šå€‹æ¬„ä½æ™‚ï¼Œä¸ç”¨ä¸€å€‹å€‹å¯« if åˆ¤æ–·ã€‚<br>ä½†æ˜¯å®‰å…¨æ€§å„ªå…ˆ â†’ ç”¨ isset() ä¸€å€‹å€‹æ›´æ–°æ¬„ä½ï¼Œæˆ‘æœ€é‚„æ˜¯é¸æ“‡ä½¿ç”¨é€™å€‹</p>
<h1 id="AuthController-å®Œæˆä¹‹å¾Œï¼Œè¨­å®š-Route"><a href="#AuthController-å®Œæˆä¹‹å¾Œï¼Œè¨­å®š-Route" class="headerlink" title="AuthController å®Œæˆä¹‹å¾Œï¼Œè¨­å®š Route"></a>AuthController å®Œæˆä¹‹å¾Œï¼Œè¨­å®š Route</h1><p>ç¾åœ¨æœ‰äº†å®Œæ•´çš„ å¾Œç«¯ JWT èªè­‰æµç¨‹ï¼Œ<br>æ¥è‘—ç¢ºä¿çš„ routes&#x2F;api.php æœ‰å°æ‡‰çš„ API è·¯ç”±</p>
<p>æ‰èƒ½å†å‘¼å«apiçš„æ™‚å€™æœ‰åæ‡‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">use App\Http\Controllers\AuthController;</span><br><span class="line"></span><br><span class="line">Route::post(&#x27;/login&#x27;, [AuthController::class, &#x27;login&#x27;]);</span><br><span class="line">Route::post(&#x27;/register&#x27;, [AuthController::class, &#x27;register&#x27;]);</span><br><span class="line"></span><br><span class="line">// éœ€è¦ JWT é©—è­‰çš„è·¯ç”±</span><br><span class="line">Route::middleware(&#x27;auth:api&#x27;)-&gt;group(function () &#123;</span><br><span class="line">    Route::get(&#x27;/me&#x27;, [AuthController::class, &#x27;me&#x27;]);</span><br><span class="line">    Route::post(&#x27;/logout&#x27;, [AuthController::class, &#x27;logout&#x27;]);</span><br><span class="line">    Route::put(&#x27;/profile&#x27;, [AuthController::class, &#x27;updateProfile&#x27;]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="è¨­å®š-JWT-middlewareï¼Œ"><a href="#è¨­å®š-JWT-middlewareï¼Œ" class="headerlink" title="è¨­å®š JWT middlewareï¼Œ"></a>è¨­å®š JWT middlewareï¼Œ</h2><p>ç¢ºèª config&#x2F;auth.php è£¡çš„ guards æœ‰è¨­å®š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x27;guards&#x27; =&gt; [</span><br><span class="line">    &#x27;web&#x27; =&gt; [</span><br><span class="line">        &#x27;driver&#x27; =&gt; &#x27;session&#x27;,</span><br><span class="line">        &#x27;provider&#x27; =&gt; &#x27;users&#x27;,</span><br><span class="line">    ],</span><br><span class="line">    // æ–°å¢ä¸€å€‹ &#x27;api&#x27; guardï¼Œä½¿ç”¨ &#x27;jwt&#x27; é©…å‹•</span><br><span class="line">    &#x27;api&#x27; =&gt; [</span><br><span class="line">        &#x27;driver&#x27; =&gt; &#x27;jwt&#x27;,</span><br><span class="line">        &#x27;provider&#x27; =&gt; &#x27;users&#x27;,</span><br><span class="line">        &#x27;hash&#x27; =&gt; false,</span><br><span class="line">    ],</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<p>é€™æ¨£ auth()-&gt;user() æ‰æœƒåœ¨ API ä¸­æ‹¿åˆ° JWT å°æ‡‰çš„ä½¿ç”¨è€…ã€‚</p>
<p>ä¹‹å¾Œå¯èƒ½è¦æ‰¾æ™‚é–“ç ”ç©¶laravelå‘½åæ…£ä¾‹ï¼Œé€™æ¬¡åœ¨å‘½åä¸Šåƒäº†ä¸å°‘è‹¦é ­</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://nikiweikame.github.io/2025/09/22/%E8%AB%8BAI%E5%8D%94%E5%8A%A9%E6%88%91%E9%96%8B%E7%99%BC-part11/" data-id="cmfyy9a800000xlbogx025v52" data-title="è«‹AIå”åŠ©æˆ‘é–‹ç™¼-part11" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/back-end/" rel="tag">back-end</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/09/25/%E8%AB%8BAI%E5%8D%94%E5%8A%A9%E6%88%91%E9%96%8B%E7%99%BC-part12/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Neuer</strong>
      <div class="article-nav-title">
        
          è«‹AIå”åŠ©æˆ‘é–‹ç™¼-part12
        
      </div>
    </a>
  
  
    <a href="/2025/09/19/%E4%B8%8D%E8%B2%A0%E8%B2%AC%E4%BB%BB%E7%9A%84%E6%8E%A1%E8%B2%B7%E6%85%BE%E6%9C%9B/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ã„lter</strong>
      <div class="article-nav-title">ä¸è² è²¬ä»»çš„æ¡è²·æ…¾æœ›</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Account-book/" rel="tag">Account book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/back-end/" rel="tag">back-end</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/diary/" rel="tag">diary</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/marry/" rel="tag">marry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/note/" rel="tag">note</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notes/" rel="tag">notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shopping-cart/" rel="tag">shopping_cart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/start/" rel="tag">start</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AI/" style="font-size: 13.33px;">AI</a> <a href="/tags/Account-book/" style="font-size: 10px;">Account book</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/back-end/" style="font-size: 16.67px;">back-end</a> <a href="/tags/diary/" style="font-size: 20px;">diary</a> <a href="/tags/marry/" style="font-size: 10px;">marry</a> <a href="/tags/note/" style="font-size: 10px;">note</a> <a href="/tags/notes/" style="font-size: 10px;">notes</a> <a href="/tags/shopping-cart/" style="font-size: 10px;">shopping_cart</a> <a href="/tags/start/" style="font-size: 10px;">start</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/11/">November 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/11/21/%E7%AC%AC%E4%B8%80%E4%BB%BD%E4%BD%9C%E5%93%81%E7%AE%97%E6%98%AF%E7%B5%90%E6%9D%9F%E4%BA%86/">ç¬¬ä¸€ä»½ä½œå“ç®—æ˜¯çµæŸäº†</a>
          </li>
        
          <li>
            <a href="/2025/11/19/%E4%B8%8B%E4%B8%80%E5%80%8B%E7%9B%AE%E6%A8%99%EF%BC%8C%E5%AF%A6%E4%BD%9C%E4%B8%80%E5%80%8BC-%E7%9A%84%E5%BE%8C%E7%AB%AF/">ä¸‹ä¸€å€‹ç›®æ¨™ï¼Œå¯¦ä½œä¸€å€‹C#çš„å¾Œç«¯</a>
          </li>
        
          <li>
            <a href="/2025/11/15/%E5%BE%9Econtroller%E5%AF%AB%E5%88%B0DB/">å¾controllerå¯«åˆ°DB</a>
          </li>
        
          <li>
            <a href="/2025/11/14/%E4%B9%85%E9%81%95%E7%9A%84%E9%9D%A2%E8%A9%A6%E7%B5%90%E6%9D%9F%E4%BA%86/">ä¹…é•çš„é¢è©¦çµæŸäº†</a>
          </li>
        
          <li>
            <a href="/2025/11/11/%E6%B8%9B%E8%82%A5%E8%A8%88%E5%8A%83%E5%AF%A6%E8%A1%8C%E4%B8%AD/">æ¸›è‚¥è¨ˆåŠƒå¯¦è¡Œä¸­</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Niki_wei<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>